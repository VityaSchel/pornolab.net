# Как работает авторизация на pornolab.net

Про авторизацию на pornolab.net: запросы, куки, токены, сессии и прочее.

Для любой сессии на форуме используются три куки:

| Куки            | Описание                                                                      |
| --------------- | ----------------------------------------------------------------------------- |
| `bb_data`       | (Только если авторизован) токен авторизованного пользователя, срок жизни: год |
| `cookie_notice` | Неизвестно, значение постоянное: `1`, срок жизни: месяц                       |
| `testCookie`    | Неизвестно, значение постоянное: `1`, срок жизни: `Session`                   |
|                 |                                                                               |

cookie_notice и testCookie имеют SameSite=`None`, Secure=`false`, HostOnly=`true`, HttpOnly=`false`
У cookie_notice path=`/`, у testCookie path=`/forum`
У bb_data HostOnly=`false`, HttpOnly=`true`, Secure=`false`, SameSite=`None`, path=`/forum/`

У cookie_notice и testCookie Domain=`pornolab.net`, у bb_data Domain=`.pornolab.net`

Значение bb_data имеет следующий формат:

```
1-00000000-aAaAaAaAaAaAaAaAaAaA-0000000000-0000000000-0000000000-0000000000-1
```

где `0` — это любая цифра от 0 до 9, `a` или `A` — любая буква от a до z или A до Z.

Я попробовал несколько раз войти в свой аккаунт и у токенов были разными только 4 цифры в конце предпоследнего числа из 10 цифр. После тщательного анализа токенов я пришел к выводу что эта часть просто отображает время входа в unix timestamp (epoch) формате в секундах.

Таким образом, токен bb_data можно разбить на следующие части, конкатенированные знаком `-`:

| Часть токена           | Описание                                                                                                                                        |
| ---------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------- |
| `1`                    | Всегда `1`                                                                                                                                      |
| `00000000`             | 10 цифр, обозначающие ID пользователя, который авторизован с этим токеном                                                                                                                             |
| `aAaAaAaAaAaAaAaAaAaA` | 20 букв латинского алфавита. Скорее всего, это и есть секретная часть токена, генерирующаяся случайным образом и проводящая процесс авторизации |
| `0000000000`           | Неизвестно, 10 цифр                                                                                                                 |
| `0000000000`           | Неизвестно, 10 цифр. Похоже на unix timestamp в секундах, но неизвестно с чем связано                                                                                                                 |
| `0000000000`           | Дата входа в фомрате unix timestamp, секунды                                                                                                                 |
| `0000000000`           | Неизвестно, 10 цифр                                                                                                                 |
| `1`                    | Всегда `1`                                                                                                                                      |
|                        |                                                                                                                                                 |

Попробуйте сделать GET запрос к `https://pornolab.net/forum/index.php` с заголовком Cookie вида
```
bb_data=1-00000000-aAaAaAaAaAaAaAaAaAaA-0000000000-0000000000-0000000000-0000000000-1; testCookie=1; cookie_notice=1
```

Если среди HTML ответа вы видите юзернейм, бекенд вас авторизовал.